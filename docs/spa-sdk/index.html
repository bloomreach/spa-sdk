<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Astro v2.10.4">
<link rel="icon" type="image/svg+xml" href="/spa-sdk/docs/favicon.svg">
<link rel="sitemap" href="/sitemap.xml">
    <title data-pagefind-meta="title">
      SPA SDK
    </title>
    <script>
      if (localStorage.getItem('theme') === null) {
        document.documentElement.setAttribute('data-theme', 'light');
      } else document.documentElement.setAttribute('data-theme', localStorage.getItem('theme'));
    </script>
    
  <link rel="stylesheet" href="/spa-sdk/docs/_astro/changelog.161d299a.css" /><script type="module" src="/spa-sdk/docs/_astro/hoisted.9c1e6001.js"></script></head>

  <body>
    <header id="header">
  <div class="navbar">
    <div class="navbar-start">
      <div class="dropdown">
        <label tabindex="0" class="btn btn-ghost btn-circle lg:hidden">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
          </svg>
        </label>
        <ul class="menu dropdown-content bg-base-100 dark:bg-base-200 rounded-box shadow w-max z-10" }>
  <li class="nav-link">
          <a href="/spa-sdk/docs/getting-started">
            Getting started
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/spa-sdk" class="active">
            SPA SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/react-sdk">
            React SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/ng-sdk">
            Angular SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/vue-sdk">
            Vue SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/migration-guide">
            Migration guide
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/changelog">
            Changelog
          </a>
        </li>
  <li>
    <a href="https://github.com/bloomreach/spa-sdk/releases" target="_blank">Releases</a>
  </li>
  <li>
    <a href="https://bloomreach.github.io/spa-sdk/" target="_blank">Typedoc</a>
  </li>
</ul>
      </div>
      <a class="btn btn-ghost" href="/spa-sdk/docs/">
        <svg width="24" height="24" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .cls-1 {
        fill: hsl(var(--nc));
      }
      .cls-2 {
        fill: hsl(var(--s));
      }
    </style>
  </defs>
  <circle class="cls-2" cx="35.94" cy="35.94" r="35.94"></circle>
  <path class="cls-1" d="M43.22,28.47,41.46,33a6.6,6.6,0,0,1,3,5.64,6.38,6.38,0,1,1-12.76,0A6.36,6.36,0,0,1,37.83,32l1.65-4.6A11,11,0,0,0,26.71,38.29h0V49.84h5V48a11.7,11.7,0,0,0,6.38,1.82,11.26,11.26,0,0,0,5.11-21.37Z"></path>
  <path class="cls-1" d="M26.69,27.92a15.51,15.51,0,0,1,5-3.41V17.27h-5Z"></path>
</svg>
        <h1>SDK Documentation Portal</h1>
      </a>
    </div>
    <div class="navbar-center"></div>
    <div class="navbar-end">
      <button class="btn btn-ghost btn-circle" id="searchModalTrigger">
        <svg viewBox="0 0 24 24" width="24" height="24" astro-icon="mdi:magnify"><path fill="currentColor" d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </button>
      <label class="btn btn-ghost btn-circle swap swap-rotate">
  <!-- this hidden checkbox controls the state -->
  <input type="checkbox" data-toggle-theme="light,dark">

  <!-- sun icon -->
  <svg class="swap-on" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
  </svg>

  <!-- moon icon -->
  <svg class="swap-off" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
  </svg>
</label>
    </div>
  </div>
</header>

<dialog id="searchModal" class="modal">
  <form method="dialog" class="modal-box p-10">
    <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">
      <svg viewBox="0 0 24 24" width="24" height="24" astro-icon="mdi:close"><path fill="currentColor" d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
    </button>
    <div class="search mt-5">
      <div data-pagefind-ui data-bundle-path="/spa-sdk/docs/_pagefind/"></div>
    </div>
  </form>
  <form method="dialog" class="modal-backdrop">
    <button>Close</button>
  </form>
</dialog>

    <main class="grid lg:grid-cols-4 gap-x-10 p-10">
      <aside class="hidden lg:block col-span-1">
        <nav class="sticky top-0">
          <ul class="menu z-10" }>
  <li class="nav-link">
          <a href="/spa-sdk/docs/getting-started">
            Getting started
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/spa-sdk" class="active">
            SPA SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/react-sdk">
            React SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/ng-sdk">
            Angular SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/vue-sdk">
            Vue SDK
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/migration-guide">
            Migration guide
          </a>
        </li><li class="nav-link">
          <a href="/spa-sdk/docs/changelog">
            Changelog
          </a>
        </li>
  <li>
    <a href="https://github.com/bloomreach/spa-sdk/releases" target="_blank">Releases</a>
  </li>
  <li>
    <a href="https://bloomreach.github.io/spa-sdk/" target="_blank">Typedoc</a>
  </li>
</ul>
        </nav>
      </aside>
      <div class="col-span-3 lg:col-span-2">
        <article>
          <div class="block lg:hidden">
            <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var d;{let p={0:t=>u(t),1:t=>l(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(l(t)),5:t=>new Set(l(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},h=t=>{let[e,n]=t;return e in p?p[e](n):void 0},l=t=>t.map(h),u=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,n])=>[e,h(n)]));customElements.get("astro-island")||customElements.define("astro-island",(d=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=async()=>{var i;if(!this.hydrator||!this.isConnected)return;let e=(i=this.parentElement)==null?void 0:i.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let n=this.querySelectorAll("astro-slot"),o={},a=this.querySelectorAll("template[data-astro-template]");for(let r of a){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(o[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of n){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(o[r.getAttribute("name")||"default"]=r.innerHTML)}let c;try{c=this.hasAttribute("props")?u(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}await this.hydrator(this)(this.Component,c,o,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((e,n)=>{n.disconnect(),setTimeout(()=>this.childrenConnectedCallback(),0)}).observe(this,{childList:!0})}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),n=this.getAttribute("client");if(Astro[n]===void 0){window.addEventListener(`astro:${n}`,()=>this.start(),{once:!0});return}Astro[n](async()=>{let o=this.getAttribute("renderer-url"),[a,{default:c}]=await Promise.all([import(this.getAttribute("component-url")),o?import(o):()=>()=>{}]),i=this.getAttribute("component-export")||"default";if(!i.includes("."))this.Component=a[i];else{this.Component=a;for(let r of i.split("."))this.Component=this.Component[r]}return this.hydrator=c,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},d.observedAttributes=["props"],d))}})();</script><astro-island uid="I1Yoo" prefix="r0" component-url="/spa-sdk/docs/_astro/TableOfContents.ba90f8bc.js" component-export="default" renderer-url="/spa-sdk/docs/_astro/client.2ce19805.js" props="{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;bloomreach-spa-sdk&quot;],&quot;text&quot;:[0,&quot;Bloomreach SPA SDK&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;features&quot;],&quot;text&quot;:[0,&quot;Features&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;get-started&quot;],&quot;text&quot;:[0,&quot;Get Started&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;installation&quot;],&quot;text&quot;:[0,&quot;Installation&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;usage&quot;],&quot;text&quot;:[0,&quot;Usage&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;relevance-integration&quot;],&quot;text&quot;:[0,&quot;Relevance Integration&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;rendering-html-content-safely&quot;],&quot;text&quot;:[0,&quot;Rendering HTML content safely&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;persist-preview-data-for-pages-without-sdk-instance&quot;],&quot;text&quot;:[0,&quot;Persist preview data for pages without SDK instance&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;important-notes&quot;],&quot;text&quot;:[0,&quot;Important notes&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;license&quot;],&quot;text&quot;:[0,&quot;License&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;reference&quot;],&quot;text&quot;:[0,&quot;Reference&quot;]}]]]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;TableOfContents&quot;,&quot;value&quot;:true}" await-children=""><nav class="sticky top-0"><ul class="menu"><li><h2 id="on-this-page-heading" class="menu-title"><span class="">On this page</span></h2><ul><li><a href="#features" class="">Features</a></li><li><a href="#get-started" class="">Get Started</a></li><li><a href="#installation" class="">Installation</a></li><li><a href="#usage" class="">Usage</a></li><li><a href="#relevance-integration" class="">Relevance Integration</a></li><li><a href="#rendering-html-content-safely" class="">Rendering HTML content safely</a></li><li><a href="#persist-preview-data-for-pages-without-sdk-instance" class="">Persist preview data for pages without SDK instance</a></li><li><a href="#important-notes" class="">Important notes</a></li><li><a href="#license" class="">License</a></li><li><a href="#reference" class="">Reference</a></li></ul></li></ul><div class="divider lg:hidden"></div></nav></astro-island>
          </div>
          <section class="prose" data-pagefind-body>
            
  <h1 id="bloomreach-spa-sdk">Bloomreach SPA SDK</h1>
<p>Bloomreach SPA SDK provides simplified headless integration
with <a href="https://www.bloomreach.com/en/products/content">Bloomreach Content</a>
for JavaScript-based applications. This library interacts with
the <a href="https://documentation.bloomreach.com/library/concepts/page-model-api/introduction.html">Page Model API</a>
and exposes a simplified and framework-agnostic interface over the page model.</p>
<h2 id="features">Features</h2>
<ul>
<li>Page Model API Client</li>
<li>Page Model Javascript implementation</li>
<li>URL Generator</li>
<li>Integration with Bloomreach Experience Manager Preview</li>
</ul>
<h2 id="get-started">Get Started</h2>
<h3 id="installation">Installation</h3>
<p>To get the SDK into your project with <a href="https://docs.npmjs.com/cli/npm">NPM</a>:</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #B392F0">npm</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">install</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">@bloomreach/spa-sdk</span></span></code></pre>
<p>And with <a href="https://yarnpkg.com">Yarn</a>:</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #B392F0">yarn</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">add</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">@bloomreach/spa-sdk</span></span></code></pre>
<h3 id="usage">Usage</h3>
<p>The following code snippet requests a related page model and shows the page’s title.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> axios </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"axios"</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> { initialize } </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"@bloomreach/spa-sdk"</span><span style="color: #E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F97583">async</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">function</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">showPage</span><span style="color: #E1E4E8">(</span><span style="color: #FFAB70">path</span><span style="color: #E1E4E8">) {</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">page</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">await</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">initialize</span><span style="color: #E1E4E8">({</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #6A737D">// The path to request from the Page Model API, should include query</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #6A737D">// parameters if those are present in the url</span></span>
<span class="line"><span style="color: #E1E4E8">    path,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #6A737D">// The location of the Page Model API of the brX channel</span></span>
<span class="line"><span style="color: #E1E4E8">    endpoint: </span><span style="color: #9ECBFF">"http://localhost:8080/delivery/site/v1/channels/brxsaas/pages"</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #6A737D">// The httpClient used to make requests</span></span>
<span class="line"><span style="color: #E1E4E8">    httpClient: axios,</span></span>
<span class="line"><span style="color: #E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">  document.</span><span style="color: #B392F0">querySelector</span><span style="color: #E1E4E8">(</span><span style="color: #9ECBFF">"#title"</span><span style="color: #E1E4E8">).innerText </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> page.</span><span style="color: #B392F0">getTitle</span><span style="color: #E1E4E8">();</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #B392F0">showPage</span><span style="color: #E1E4E8">(</span><span style="color: #9ECBFF">`${</span><span style="color: #E1E4E8">window</span><span style="color: #9ECBFF">.</span><span style="color: #E1E4E8">location</span><span style="color: #9ECBFF">.</span><span style="color: #E1E4E8">pathname</span><span style="color: #9ECBFF">}${</span><span style="color: #E1E4E8">window</span><span style="color: #9ECBFF">.</span><span style="color: #E1E4E8">location</span><span style="color: #9ECBFF">.</span><span style="color: #E1E4E8">search</span><span style="color: #9ECBFF">}`</span><span style="color: #E1E4E8">);</span></span></code></pre>
<h3 id="relevance-integration">Relevance Integration</h3>
<p>(not applicable to Content SaaS)</p>
<p>The SDK provides basic <a href="https://expressjs.com/en/guide/using-middleware.html">Express
middleware</a> for seamless
integration
with <a href="https://documentation.bloomreach.com/14/library/enterprise/enterprise-features/targeting/targeting.html">the Relevance Module</a>.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> express </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"express"</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> { relevance } </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"@bloomreach/spa-sdk/dist/express"</span><span style="color: #E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">app</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">express</span><span style="color: #E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">app.</span><span style="color: #B392F0">use</span><span style="color: #E1E4E8">(relevance);</span></span></code></pre>
<p>The middleware can be customized using the <code>withOptions</code> method.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">app.</span><span style="color: #B392F0">use</span><span style="color: #E1E4E8">(relevance.</span><span style="color: #B392F0">withOptions</span><span style="color: #E1E4E8">({ name: </span><span style="color: #9ECBFF">"_visitor"</span><span style="color: #E1E4E8">, maxAge: </span><span style="color: #79B8FF">24</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">*</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">60</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">*</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">60</span><span style="color: #E1E4E8"> }));</span></span></code></pre>
<h3 id="rendering-html-content-safely">Rendering HTML content safely</h3>
<p>You should/must sanitize any HTML content returned in the page model for security reasons. Before the removal of the
sanitize method, we used the <a href="https://www.npmjs.com/package/sanitize-html"><code>sanitize-html</code></a> package in the SDK for this purpose. You can now use your preferred
sanitization libraries or techniques based on your project requirements. Make sure to preserve the <code>data-type</code> attribute
on links in the rich content fields when sanitizing as it lets the SDK determine which links are external and which are
internal when using the <a href="https://bloomreach.github.io/spa-sdk/interfaces/index.Page.html#rewriteLinks"><code>rewriteLinks</code></a> method.</p>
<p>For example, in a React example, you may sanitize and render the HTML content which came from the backend like the
following example:</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> sanitize </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">'sanitize-html'</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #E1E4E8">  </span></span>
<span class="line"><span style="color: #F97583">function</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">sanitizeRichContent</span><span style="color: #E1E4E8">(</span><span style="color: #FFAB70">content</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">string</span><span style="color: #E1E4E8">)</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">string</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">return</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">sanitize</span><span style="color: #E1E4E8">(content, {</span></span>
<span class="line"><span style="color: #E1E4E8">    allowedAttributes: {</span></span>
<span class="line"><span style="color: #E1E4E8">      a: [</span><span style="color: #9ECBFF">'href'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'name'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'target'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'title'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'data-type'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'rel'</span><span style="color: #E1E4E8">],</span></span>
<span class="line"><span style="color: #E1E4E8">      img: [</span><span style="color: #9ECBFF">'src'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'srcset'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'alt'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'title'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'width'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'height'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'loading'</span><span style="color: #E1E4E8">],</span></span>
<span class="line"><span style="color: #E1E4E8">    },</span></span>
<span class="line"><span style="color: #E1E4E8">    allowedTags: sanitizeHTML.defaults.allowedTags.</span><span style="color: #B392F0">concat</span><span style="color: #E1E4E8">([</span><span style="color: #9ECBFF">'img'</span><span style="color: #E1E4E8">]),</span></span>
<span class="line"><span style="color: #E1E4E8">  });</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span>
<span class="line"><span style="color: #6A737D">/* ... */</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">/* Suppose the content.value below contains HTML markups string. */</span></span>
<span class="line"><span style="color: #E1E4E8">&#x3C;</span><span style="color: #85E89D">div</span><span style="color: #E1E4E8">></span></span>
<span class="line"><span style="color: #E1E4E8">   {content </span><span style="color: #F97583">&#x26;&#x26;</span><span style="color: #E1E4E8"> &#x3C;</span><span style="color: #85E89D">div</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">dangerouslySetInnerHTML</span><span style="color: #F97583">=</span><span style="color: #E1E4E8">{{ __html: page.</span><span style="color: #B392F0">rewriteLinks</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">sanitizeRichContent</span><span style="color: #E1E4E8">(content.value)) }} />}</span></span>
<span class="line"><span style="color: #E1E4E8">&#x3C;/</span><span style="color: #85E89D">div</span><span style="color: #E1E4E8">></span></span></code></pre>
<p>The same principle may apply in other frameworks. e.g, <code>v-html</code> in Vue.js or <code>[innerHTML]</code> in Angular.</p>
<h2 id="persist-preview-data-for-pages-without-sdk-instance">Persist preview data for pages without SDK instance</h2>
<p>If you are using the SPA SDK selectively on certain pages, you will need to persist the preview related data when
navigating between pages that have and those that don’t have a SDK instance. The easiest way to achieve this result is
by making use of the cookie storage as illustrated below.</p>
<p>The following snippet of the code shows the possible implementation of a function which builds a Configuration object to
pass into the <code>initialize</code> function from the SPA SDK or directly to a <code>BrPage</code> component.
It reads preview data from the query string and saves it to the cookies, restoring that data if it not available in a
query string. To manage the cookies you could use <code>cookie</code> library or any other library.</p>
<h3 id="important-notes">Important notes</h3>
<ul>
<li>The preview site should be served on a separate domain compared to the live site to avoid saving preview related
cookies for the live site.</li>
<li>In case, when the first page which is loading in preview doesn’t use SPA SDK you should parse query parameters and
save preview related data to the cookies by yourself.</li>
</ul>
<p>This is a generic example and you should adjust it to your specific framework.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> axios </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">'axios'</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> cookie </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">'cookie'</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> { Configuration } </span><span style="color: #F97583">from</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">'@bloomreach/spa-sdk'</span><span style="color: #E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F97583">export</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">default</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">function</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">buildConfiguration</span><span style="color: #E1E4E8">()</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">Configuration</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">PREVIEW_TOKEN_KEY</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">'token'</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">PREVIEW_SERVER_ID_KEY</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">'server-id'</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #6A737D">// Read a token and server id from the query string</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">searchParams</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">new</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">URLSearchParams</span><span style="color: #E1E4E8">(window.location.search);</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">queryToken</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> searchParams.</span><span style="color: #B392F0">get</span><span style="color: #E1E4E8">(</span><span style="color: #79B8FF">PREVIEW_TOKEN_KEY</span><span style="color: #E1E4E8">);</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">queryServerId</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> searchParams.</span><span style="color: #B392F0">get</span><span style="color: #E1E4E8">(</span><span style="color: #79B8FF">PREVIEW_SERVER_ID_KEY</span><span style="color: #E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">cookies</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> cookie.</span><span style="color: #B392F0">parse</span><span style="color: #E1E4E8">(document.cookie);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #6A737D">// Prioritize values from the query string because cookies might be outdated.</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">authorizationToken</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> queryToken </span><span style="color: #F97583">??</span><span style="color: #E1E4E8"> cookies[</span><span style="color: #79B8FF">PREVIEW_TOKEN_KEY</span><span style="color: #E1E4E8">];</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">serverId</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> queryServerId </span><span style="color: #F97583">??</span><span style="color: #E1E4E8"> cookies[</span><span style="color: #79B8FF">PREVIEW_SERVER_ID_KEY</span><span style="color: #E1E4E8">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #6A737D">// Save the values from the query string to have ability to restore them when switch back from legacy page to the SPA-SDK rendered page.</span></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">if</span><span style="color: #E1E4E8"> (queryToken) {</span></span>
<span class="line"><span style="color: #E1E4E8">    document.cookie </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> cookie.</span><span style="color: #B392F0">serialize</span><span style="color: #E1E4E8">(</span><span style="color: #79B8FF">PREVIEW_TOKEN_KEY</span><span style="color: #E1E4E8">, queryToken);</span></span>
<span class="line"><span style="color: #E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">if</span><span style="color: #E1E4E8"> (queryServerId) {</span></span>
<span class="line"><span style="color: #E1E4E8">    document.cookie </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> cookie.</span><span style="color: #B392F0">serialize</span><span style="color: #E1E4E8">(</span><span style="color: #79B8FF">PREVIEW_SERVER_ID_KEY</span><span style="color: #E1E4E8">, queryServerId);</span></span>
<span class="line"><span style="color: #E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">const</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">configuration</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">    endpoint: </span><span style="color: #9ECBFF">'your-pda-endpoint'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    httpClient: axios,</span></span>
<span class="line"><span style="color: #E1E4E8">    path: </span><span style="color: #9ECBFF">`${</span><span style="color: #E1E4E8">location</span><span style="color: #9ECBFF">.</span><span style="color: #E1E4E8">pathname</span><span style="color: #9ECBFF">}${</span><span style="color: #E1E4E8">location</span><span style="color: #9ECBFF">.</span><span style="color: #E1E4E8">search</span><span style="color: #9ECBFF">}`</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #6A737D">// Provide authorization token and server id if they exist to the SPA-SDK initialization method.</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #F97583">...</span><span style="color: #E1E4E8">(authorizationToken </span><span style="color: #F97583">?</span><span style="color: #E1E4E8"> { authorizationToken } </span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> {}),</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #F97583">...</span><span style="color: #E1E4E8">(serverId </span><span style="color: #F97583">?</span><span style="color: #E1E4E8"> { serverId } </span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> {}),</span></span>
<span class="line"><span style="color: #E1E4E8">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">  </span><span style="color: #F97583">return</span><span style="color: #E1E4E8"> configuration;</span></span>
<span class="line"><span style="color: #E1E4E8">};</span></span>
<span class="line"></span></code></pre>
<h2 id="license">License</h2>
<p>Published under <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a> license.</p>
<h2 id="reference">Reference</h2>
<p>Typedoc for the SPA SDK is automatically generated and published
to <a href="https://bloomreach.github.io/spa-sdk/modules/index.html">https://bloomreach.github.io/spa-sdk/modules/index.html</a></p>

          </section>
        </article>
      </div>
      <aside class="hidden lg:block col-span-1">
        <astro-island uid="I1Yoo" prefix="r1" component-url="/spa-sdk/docs/_astro/TableOfContents.ba90f8bc.js" component-export="default" renderer-url="/spa-sdk/docs/_astro/client.2ce19805.js" props="{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;bloomreach-spa-sdk&quot;],&quot;text&quot;:[0,&quot;Bloomreach SPA SDK&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;features&quot;],&quot;text&quot;:[0,&quot;Features&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;get-started&quot;],&quot;text&quot;:[0,&quot;Get Started&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;installation&quot;],&quot;text&quot;:[0,&quot;Installation&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;usage&quot;],&quot;text&quot;:[0,&quot;Usage&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;relevance-integration&quot;],&quot;text&quot;:[0,&quot;Relevance Integration&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;rendering-html-content-safely&quot;],&quot;text&quot;:[0,&quot;Rendering HTML content safely&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;persist-preview-data-for-pages-without-sdk-instance&quot;],&quot;text&quot;:[0,&quot;Persist preview data for pages without SDK instance&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;important-notes&quot;],&quot;text&quot;:[0,&quot;Important notes&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;license&quot;],&quot;text&quot;:[0,&quot;License&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;reference&quot;],&quot;text&quot;:[0,&quot;Reference&quot;]}]]]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;TableOfContents&quot;,&quot;value&quot;:true}" await-children=""><nav class="sticky top-0"><ul class="menu"><li><h2 id="on-this-page-heading" class="menu-title"><span class="">On this page</span></h2><ul><li><a href="#features" class="">Features</a></li><li><a href="#get-started" class="">Get Started</a></li><li><a href="#installation" class="">Installation</a></li><li><a href="#usage" class="">Usage</a></li><li><a href="#relevance-integration" class="">Relevance Integration</a></li><li><a href="#rendering-html-content-safely" class="">Rendering HTML content safely</a></li><li><a href="#persist-preview-data-for-pages-without-sdk-instance" class="">Persist preview data for pages without SDK instance</a></li><li><a href="#important-notes" class="">Important notes</a></li><li><a href="#license" class="">License</a></li><li><a href="#reference" class="">Reference</a></li></ul></li></ul><div class="divider lg:hidden"></div></nav></astro-island>
      </aside>
    </main>
  </body>
</html>